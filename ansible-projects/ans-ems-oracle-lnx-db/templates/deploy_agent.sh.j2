#!/bin/bash 
# Agent Deploy Script generated by ANSIBLE 

{% if ( (srvrole == 'DEV') and (srvloc == 'NA') ) %}
echo "Deploying EM Agent to NA EM13c DEV"
export TMP=/Export/tmp
export SWLOCDIR=/Export/staging/Oracle_Binary
mkdir -p /Export/tmp /Export/staging/Oracle_Binary
cd $SWLOCDIR
curl "{{ em13c_loc.nadev }}:4903/em/install/getAgentImage" --insecure -o AgentPull.sh
chmod +x AgentPull.sh
chown oracle:oinstall AgentPull.sh
./AgentPull.sh -showPlatforms
./AgentPull.sh -showGoldImageVersions 
./AgentPull.sh LOGIN_USER=sysman LOGIN_PASSWORD={{ emsys_pw }} \
IMAGE_NAME=EM_GOLD_AGENT \
PLATFORM="Linux x86-64" AGENT_REGISTRATION_PASSWORD={{ emsys_pw }} \
AGENT_BASE_DIR={{ agt_inst_dir.install_dir }} \
ORACLE_HOSTNAME=`hostname -f`
{% elif ( (srvrole == 'PROD') and (srvloc == 'NA') ) %}
echo "Deploying EM Agent to NA EM13c PROD"
export TMP=/Export/tmp
export SWLOCDIR=/Export/staging/Oracle_Binary
mkdir -p /Export/tmp /Export/staging/Oracle_Binary
cd $SWLOCDIR
curl "{{ em13c_loc.naprod }}:4903/em/install/getAgentImage" --insecure -o AgentPull.sh
chmod +x AgentPull.sh
chown oracle:oinstall AgentPull.sh
./AgentPull.sh -showPlatforms
./AgentPull.sh -showGoldImageVersions 
./AgentPull.sh LOGIN_USER=sysman LOGIN_PASSWORD={{ emsys_pw }} \
IMAGE_NAME=EM_GOLD_AGENT \
PLATFORM="Linux x86-64" AGENT_REGISTRATION_PASSWORD={{ emsys_pw }} \
AGENT_BASE_DIR={{ agt_inst_dir.install_dir }} \
ORACLE_HOSTNAME=`hostname -f`
{% elif ( (srvrole == 'DEV') and (srvloc == 'EU') ) %}
echo "Deploying EM Agent to EU EM13c DEV"
export TMP=/Export/tmp
export SWLOCDIR=/Export/staging/Oracle_Binary
mkdir -p /Export/tmp /Export/staging/Oracle_Binary
cd $SWLOCDIR
curl "{{ em13c_loc.eudev }}:4903/em/install/getAgentImage" --insecure -o AgentPull.sh
chmod +x AgentPull.sh
chown oracle:oinstall AgentPull.sh
./AgentPull.sh -showPlatforms
./AgentPull.sh -showGoldImageVersions 
./AgentPull.sh LOGIN_USER=sysman LOGIN_PASSWORD={{ emsys_pw }} \
IMAGE_NAME=EM_GOLD_AGENT \
PLATFORM="Linux x86-64" AGENT_REGISTRATION_PASSWORD={{ emsys_pw }} \
AGENT_BASE_DIR={{ agt_inst_dir.install_dir }} \
ORACLE_HOSTNAME=`hostname -f`
{% elif ( (srvrole == 'PROD') and (srvloc == 'EU') ) %}
echo "Deploying EM Agent to EU EM13c PROD"
export TMP=/Export/tmp
export SWLOCDIR=/Export/staging/Oracle_Binary
mkdir -p /Export/tmp /Export/staging/Oracle_Binary
cd $SWLOCDIR
curl "{{ em13c_loc.euprod }}:4903/em/install/getAgentImage" --insecure -o AgentPull.sh
chmod +x AgentPull.sh
chown oracle:oinstall AgentPull.sh
./AgentPull.sh -showPlatforms
./AgentPull.sh -showGoldImageVersions 
./AgentPull.sh LOGIN_USER=sysman LOGIN_PASSWORD={{ emsys_pw }} \
IMAGE_NAME=EM_GOLD_AGENT \
PLATFORM="Linux x86-64" AGENT_REGISTRATION_PASSWORD={{ emsys_pw }} \
AGENT_BASE_DIR={{ agt_inst_dir.install_dir }} \
ORACLE_HOSTNAME=`hostname -f`
{% else %}
{% endif %}

## Root script
#echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++"
#echo running EM13c Agent root script
#echo "++++++++++++++++++++++++++++++++++++++++++++++++++++++"
#export AGT_VER=`sudo -u oracle /U01/app/oracle/product/Agent13c/agent_inst/bin/emctl status agent |grep "Agent Version" | awk -F ': ' '{print $2}'`
#echo "Agent Version is: $AGT_VER"
#export AGT_BIN=`sudo -u oracle /U01/app/oracle/product/Agent13c/agent_inst/bin/emctl status agent |grep "Agent Binaries" | awk -F ': ' '{print $2}'`
#echo "AGENT Home is: $AGT_BIN"
#$AGT_BIN/root.sh